# 장애와 회복

### 장애의 유형

- 트랜잭션 장애
- 시스템 장애
- 미디어 장애

## 트랜잭션 장애

1.  트랜잭션 내 잘못된 데이터 입력
2.  데이터 부재
3.  오버플로우
4.  자원의 한계 초과 요청
5.  어떤 수를 0으로 나누게 되는 연산 등

## 시스템 장애

1. 하드웨어의 잘못된 작동으로 메인 메모리에 저장되어 있는 정보 손실
2. 교착 상태의 발생으로 더 이상 트랜잭션 작업이 수행될 수 없는 상황

## 미디어 장애

1. 디스크 헤드 손상, 물리적 손상

## 회복

장애가 발생했던 이전의 상태로 복구시켜 일관된 상태를 만드는 것.

### 액션

1. Redo(재수행)
2. Undo(취소)

### 회복의 유형

1. 데이터베이스 로그를 이용한 회복 : 로그 레코드 이용

- 지연 갱신의 회복 : 부분 완료될 때까지 모든 변경 내용에 대해 DB 갱신을 지연시키고, 로그 파일에만 저장. 원자성 보장. 트랜잭션이 부분완료되면, 기록된 로그 파일을 토대로 DB에 전부 반영됨. 철회시 로그 파일만 버리면 됨.
- 즉시 갱신의 회복 : 변경 연산 발생할 떄마다 바로 DB에 반영됨. 철회 시 로그 파일에 저장된 내용 참조하여 Undo 연산을 수행.

2. 검사 시점 회복 : 로그는 그대로 기록 유지, 일정한 시간 간격으로 검사 시점을 생성하는 것. 불필요한 부하를 줄이게 됨으로 회복 처리 절차의 시간을 절약해줌. 로그를 이요한 회복 기법에서 일정마다 시간 차를 두고 확인하는 방법임. 해당 시간에 문제가 없으면 이전까지의 트랜잭션은 확인을 하지 않아도 됨. 문제 발생 시, 최근 확인했던 시간 때부터 철회를 하면 됨.

3) 그림자 페이징 기법 : 로그를 이용하지 않고, 트랜잭션을 수행하는 동안, 두 개의 페이지 테이블인 현재 페이지 테이블, 그림자 페이지 테이블을 유지.
   수행과정에서 현재 페이지 테이블만 변경되고, 그림자 페이지테이블은 실행이 완료되면 현재 페이지 테이블이 그림자 페이지 테이블로 반영됨.(그림자 페이지 테이블은 비휘발성 저장장치, 현재 페이지 ㅌ[이블은 주기억 장치에 저장)

4 미디어 회복: 덤프, 로그, 일정한 주기로 다른 저장장치에 복사함.
